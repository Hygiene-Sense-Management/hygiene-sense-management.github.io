<!DOCTYPE html>
<html>
<head>
   <title>Primary Data Processing</title>
   <meta name="generator" content="Help &amp; Manual" />
   <meta name="keywords" content="" />
   <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
   <meta http-equiv="X-UA-Compatible" content="IE=edge" />
   <link type="text/css" href="default.css" rel="stylesheet" />
   <style type="text/css">
     body { margin: 0px; background: #FFFFFF; }
   </style>
   <script type="text/javascript" src="jquery.js"></script>
   <script type="text/javascript" src="helpman_settings.js"></script>
   <script type="text/javascript" src="helpman_topicinit.js"></script>

   <script type="text/javascript">
     HMSyncTOC("index.html", "primary-data-processing.html");
   </script>
   <script type="text/javascript" src="highlight.js"></script>
   <script type="text/javascript">
     $(document).ready(function(){highlight();});
   </script>
</head>
<body>


<table style="width:100%; border:none; border-spacing:0px; padding:5px; background:#C0C0C0">
  <tr style="vertical-align:middle">
    <td style="text-align:left">
      <h1 class="p_Heading1"><span class="f_Heading1">Primary Data Processing</span></h1>

    </td>
    <td style="text-align:right">
     <a href="introduction.html">Top</a>&nbsp;
     <a href="data-link-monitoring-service-d.html">Previous</a>&nbsp;
     <a href="operations-guide2.html">Next</a>
    </td>
  </tr>
</table>


<!-- Placeholder for topic body. -->
<table style="width:100%;border:none;border-spacing:0px"><tr style="vertical-align:top"><td style="text-align:left;padding:5px">
<p class="p_Normal">HsM uses <span class="f_Identifier">Azure IoT Hub</span> infrastructure for device-to-cloud and cloud-to-device communication.</p>
<p class="p_Normal">&nbsp;</p>
<p class="p_Normal">Gateways must register with the Azure IoT Hub before they can send messages.</p>
<p class="p_Normal">Mobile gateways are registered via the Client Service. There is an enpoint that delivers connsction strings (including the shared access key)</p>
<p class="p_Normal">Stationary gateways are registered via the Device provisioning service </p>
<p class="p_Normal">&nbsp;</p>
<p class="p_Normal">Communication between the gateways and the IoT hub uses predefined protocols. I.e. the payload of messages is defined in HsM</p>
<p class="p_Normal">Following messages are possible</p>
<p class="p_Normal" style="text-indent: 0; padding-left: 13px; margin-left: 0;"><span class="f_Normal" style="font-family: Arial,'Lucida Sans Unicode','Lucida Grande','Lucida Sans';display:inline-block;width:13px;margin-left:-13px">&#8226;</span>HsM Resource Data Protocol v1</p><p class="p_Normal" style="text-indent: 0; padding-left: 13px; margin-left: 0;"><span class="f_Normal" style="font-family: Arial,'Lucida Sans Unicode','Lucida Grande','Lucida Sans';display:inline-block;width:13px;margin-left:-13px">&#8226;</span>HsM Resource Data Protocol v2</p><p class="p_Normal" style="text-indent: 0; padding-left: 13px; margin-left: 0;"><span class="f_Normal" style="font-family: Arial,'Lucida Sans Unicode','Lucida Grande','Lucida Sans';display:inline-block;width:13px;margin-left:-13px">&#8226;</span>HsM Device Link Status Protocol</p><p class="p_Normal">&nbsp;</p>
<p class="p_Normal">* Routing</p>
<p class="p_Normal">Currently not implemented because not needed</p>
<p class="p_Normal">Messages of different context can be routed to different event hub</p>
<p class="p_Normal">&nbsp;</p>
<p class="p_Normal">Consumer Groups </p>
<p class="p_Normal">* Current status storge (CSS): </p>
<p class="p_Normal"><span style="width:48px;display:inline-block">&nbsp;</span>* Currently goes to table storage</p>
<p class="p_Normal"><span style="width:48px;display:inline-block">&nbsp;</span>* Will be set to SQL server</p>
<p class="p_Normal"><span style="width:48px;display:inline-block">&nbsp;</span>* Latest Connected Gateway</p>
<p class="p_Normal"><span style="width:48px;display:inline-block">&nbsp;</span>* Latest Gateway Type</p>
<p class="p_Normal">* Raw value storage</p>
<p class="p_Normal"><span style="width:48px;display:inline-block">&nbsp;</span>* Content must be redefined</p>
<p class="p_Normal"><span style="width:48px;display:inline-block">&nbsp;</span>* Structure</p>
<p class="p_Normal"><span style="width:48px;display:inline-block">&nbsp;</span>* Conversion function</p>
<p class="p_Normal">* Time series storage</p>
<p class="p_Normal"><span style="width:48px;display:inline-block">&nbsp;</span>* Postgres</p>
<p class="p_Normal"><span style="width:48px;display:inline-block">&nbsp;</span>* </p>
<p class="p_Normal">All consumer groups have same retention period -</p>
<p class="p_Normal">Check internally for pricing</p>
<p class="p_Normal">&nbsp;</p>
<p class="p_Normal">Functions are configured to bind to Consumer groups</p>
<p class="p_Normal">This binding is same via ARM templates</p>
<p class="p_Normal">Functions can be changed to be configurable (To be done) Currently Consumer group is hardcoded</p>
<p class="p_Normal">&nbsp;</p>
<p class="p_Normal">Connections etc are encoded in the ARM template</p>
<p class="p_Normal">&nbsp;</p>
<p class="p_Normal">&nbsp;</p>
<p class="p_Normal">&nbsp;</p>
<p class="p_Normal">&nbsp;</p>
<p class="p_Normal">&nbsp;</p>
<p class="p_Normal">&nbsp;</p>
<p class="p_Normal">&nbsp;</p>

</td></tr></table>

</body>
</html>
